"use strict";(self.webpackChunkmadaster_typescript=self.webpackChunkmadaster_typescript||[]).push([[1582,8525],{21120:(t,e,n)=>{n.d(e,{w:()=>i});var s=n(3223),r=n(41785),o=n(79207);class i{constructor(t=9,e){this._compareMinX=u,this._compareMinY=c,this._toBBox=t=>t,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this._toBBox=e:this._initFormat(e)),this.clear()}destroy(){this.clear(),x.prune(),I.prune(),B.prune(),b.prune()}all(t){this._all(this._data,t)}search(t,e){let n=this._data;const s=this._toBBox;if(_(t,n))for(x.clear();n;){for(let r=0,o=n.children.length;r<o;r++){const o=n.children[r],i=n.leaf?s(o):o;_(t,i)&&(n.leaf?e(o):y(t,i)?this._all(o,e):x.push(o))}n=x.pop()}}collides(t){let e=this._data;const n=this._toBBox;if(!_(t,e))return!1;for(x.clear();e;){for(let s=0,r=e.children.length;s<r;s++){const r=e.children[s],o=e.leaf?n(r):r;if(_(t,o)){if(e.leaf||y(t,o))return!0;x.push(r)}}e=x.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}let e=this._build(t.slice(0,t.length),0,t.length-1,0);if(this._data.children.length)if(this._data.height===e.height)this._splitRoot(this._data,e);else{if(this._data.height<e.height){const t=this._data;this._data=e,e=t}this._insert(e,this._data.height-e.height-1,!0)}else this._data=e;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new v([]),this}remove(t){if(!t)return this;let e,n=this._data,r=null,o=0,i=!1;const h=this._toBBox(t);for(B.clear(),b.clear();n||B.length>0;){if(n||(n=B.pop(),r=B.data[B.length-1],o=b.pop()??0,i=!0),n.leaf&&(e=(0,s.qh)(n.children,t,n.children.length,n.indexHint),-1!==e))return n.children.splice(e,1),B.push(n),this._condense(B),this;i||n.leaf||!y(n,h)?r?(o++,n=r.children[o],i=!1):n=null:(B.push(n),b.push(o),o=0,r=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_all(t,e){let n=t;for(I.clear();n;){if(!0===n.leaf)for(const t of n.children)e(t);else I.pushArray(n.children);n=I.pop()??null}}_build(t,e,n,s){const r=n-e+1;let o=this._maxEntries;if(r<=o){const s=new v(t.slice(e,n+1));return h(s,this._toBBox),s}s||(s=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/o**(s-1)));const i=new Y([]);i.height=s;const l=Math.ceil(r/o),a=l*Math.ceil(Math.sqrt(o));p(t,e,n,a,this._compareMinX);for(let r=e;r<=n;r+=a){const e=Math.min(r+a-1,n);p(t,r,e,l,this._compareMinY);for(let n=r;n<=e;n+=l){const r=Math.min(n+l-1,e);i.children.push(this._build(t,n,r,s-1))}}return h(i,this._toBBox),i}_chooseSubtree(t,e,n,s){for(;s.push(e),!0!==e.leaf&&s.length-1!==n;){let n,s=1/0,r=1/0;for(let o=0,i=e.children.length;o<i;o++){const i=e.children[o],h=d(i),l=m(t,i)-h;l<r?(r=l,s=h<s?h:s,n=i):l===r&&h<s&&(s=h,n=i)}e=n||e.children[0]}return e}_insert(t,e,n){const s=this._toBBox,r=n?t:s(t);B.clear();const o=this._chooseSubtree(r,this._data,e,B);for(o.children.push(t),a(o,r);e>=0&&B.data[e].children.length>this._maxEntries;)this._split(B,e),e--;this._adjustParentBBoxes(r,B,e)}_split(t,e){const n=t.data[e],s=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,s);const o=this._chooseSplitIndex(n,r,s);if(!o)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const i=n.children.splice(o,n.children.length-o),l=n.leaf?new v(i):new Y(i);l.height=n.height,h(n,this._toBBox),h(l,this._toBBox),e?t.data[e-1].children.push(l):this._splitRoot(n,l)}_splitRoot(t,e){this._data=new Y([t,e]),this._data.height=t.height+1,h(this._data,this._toBBox)}_chooseSplitIndex(t,e,n){let s,r,o;s=r=1/0;for(let i=e;i<=n-e;i++){const e=l(t,0,i,this._toBBox),h=l(t,i,n,this._toBBox),a=g(e,h),u=d(e)+d(h);a<s?(s=a,o=i,r=u<r?u:r):a===s&&u<r&&(r=u,o=i)}return o}_chooseSplitAxis(t,e,n){const s=t.leaf?this._compareMinX:u,r=t.leaf?this._compareMinY:c;this._allDistMargin(t,e,n,s)<this._allDistMargin(t,e,n,r)&&t.children.sort(s)}_allDistMargin(t,e,n,s){t.children.sort(s);const r=this._toBBox,o=l(t,0,e,r),i=l(t,n-e,n,r);let h=f(o)+f(i);for(let s=e;s<n-e;s++){const e=t.children[s];a(o,t.leaf?r(e):e),h+=f(o)}for(let s=n-e-1;s>=e;s--){const e=t.children[s];a(i,t.leaf?r(e):e),h+=f(i)}return h}_adjustParentBBoxes(t,e,n){for(let s=n;s>=0;s--)a(e.data[s],t)}_condense(t){for(let e=t.length-1;e>=0;e--){const n=t.data[e];if(0===n.children.length)if(e>0){const r=t.data[e-1],o=r.children;o.splice((0,s.qh)(o,n,o.length,r.indexHint),1)}else this.clear();else h(n,this._toBBox)}}_initFormat(t){const e=["return a"," - b",";"];this._compareMinX=new Function("a","b",e.join(t[0])),this._compareMinY=new Function("a","b",e.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function h(t,e){l(t,0,t.children.length,e,t)}function l(t,e,n,s,r){r||(r=new v([])),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o,i=e;i<n;i++)o=t.children[i],a(r,t.leaf?s(o):o);return r}function a(t,e){t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY)}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function d(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function g(t,e){const n=Math.max(t.minX,e.minX),s=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-s)}function y(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function _(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t,e,n,s,r){const i=[e,n];for(;i.length;){const e=i.pop(),n=i.pop();if(e-n<=s)continue;const h=n+Math.ceil((e-n)/s/2)*s;(0,o.q)(t,h,n,e,r),i.push(n,h,h,e)}}const x=new r.A,I=new r.A,B=new r.A,b=new r.A({deallocator:void 0});class M{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class w extends M{constructor(){super(...arguments),this.height=1,this.indexHint=new s.vW}}class v extends w{constructor(t){super(),this.children=t,this.leaf=!0}}class Y extends w{constructor(t){super(),this.children=t,this.leaf=!1}}},85747:(t,e,n)=>{n.d(e,{N3:()=>r,Om:()=>s});class s{constructor(t=null,e={},n,s){this.geometry=t,this.attributes=e,this.centroid=n,this.objectId=s,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const t=new s(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}clone(){const t=this.geometry?.clone(),e=new s(t,{...this.attributes},this.centroid?.clone(),this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function r(t){return!!t.geometry?.coords?.length}},97011:(t,e,n)=>{n.d(e,{A:()=>s});class s{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new s;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}},65977:(t,e,n)=>{n.d(e,{A:()=>s});class s{constructor(t=[],e=[],n=!1){this.lengths=t??[],this.coords=e??[],this.hasIndeterminateRingOrder=n}static fromRect(t){const[e,n,r,o]=t,i=r-e,h=o-n;return new s([5],[e,n,i,0,0,h,-i,0,0,-h])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((t,e)=>t+e))}forEachVertex(t){let e=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const s=this.lengths[n];for(let n=0;n<s;n++)t(this.coords[2*(n+e)],this.coords[2*(n+e)+1]);e+=s}}deltaDecode(){const t=this.clone(),{coords:e,lengths:n}=t;let s=0;for(const t of n){for(let n=1;n<t;n++)e[2*(s+n)]+=e[2*(s+n)-2],e[2*(s+n)+1]+=e[2*(s+n)-1];s+=t}return t}clone(t){if(0===this.lengths.length)return new s([],[this.coords[0],this.coords[1]]);const e=2*(0===this.lengths.length?1:this.lengths.reduce(((t,e)=>t+e))),n=this.coords.slice(0,e);return t?(t.set(n),new s(this.lengths,t,this.hasIndeterminateRingOrder)):new s(Array.from(this.lengths),Array.from(n),this.hasIndeterminateRingOrder)}}},64411:(t,e,n)=>{n.d(e,{F:()=>h});var s=n(6273),r=n(21120),o=n(2532);const i={minX:0,minY:0,maxX:0,maxY:0};class h{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new r.w(9,(0,s.A)("esri-csp-restrictions")?t=>({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const t=new Array(this._idByBounds.size);let e=0;this._idByBounds.forEach(((n,s)=>{t[e++]=s})),this._indexInvalid=!1,this._index.clear(),this._index.load(t)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((t=>this._idByBounds.has(t)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const t=(0,o.Ie)();for(const e of this._boundsById.values())e&&(t[0]=Math.min(e[0],t[0]),t[1]=Math.min(e[1],t[1]),t[2]=Math.max(e[2],t[2]),t[3]=Math.max(e[3],t[3]));return t}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(t){const e=this._boundsById.get(t);this._boundsById.delete(t),e&&(this._idByBounds.delete(e),this._indexInvalid||this._index.remove(e))}forEachInBounds(t,e){this._loadIndex(),function(t,e,n){(function(t){i.minX=t[0],i.minY=t[1],i.maxX=t[2],i.maxY=t[3]})(e),t.search(i,n)}(this._index,t,(t=>e(this._idByBounds.get(t))))}get(t){return this._boundsById.get(t)}has(t){return this._boundsById.has(t)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(t,e){if(!this._indexInvalid){const e=this._boundsById.get(t);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(t,e),e&&(this._idByBounds.set(e,t),this._indexInvalid||(this._boundsToLoad.push(e),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},91582:(t,e,n)=>{n.d(e,{A:()=>m});var s=n(3223),r=n(62991),o=n(57888),i=n(80861),h=n(46373),l=n(2532),a=n(5525),u=n(64411),c=n(84880),d=n(46452);const f=(0,h.vt)();class m{constructor(t){this.geometryInfo=t,this._boundsStore=new u.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.A,this.featureAdapter=d.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let t=0;return this._featuresById.forEach((e=>{null!=e.geometry&&e.geometry.coords&&(t+=e.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:t/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(t){if(null==this.fullBounds)return null;const[e,n,s,r]=this.fullBounds;return{xmin:e,ymin:n,xmax:s,ymax:r,spatialReference:(0,c.ag)(t)}}add(t){this._add(t),this._emitChanged()}addMany(t){for(const e of t)this._add(e);this._emitChanged()}upsertMany(t){const e=t.map((t=>this._upsert(t)));return this._emitChanged(),e.filter(s.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(t){const e=this._featuresById.get(t);return e?(this._remove(e),this._emitChanged(),e):null}removeManyById(t){this._boundsStore.invalidateIndex();for(const e of t){const t=this._featuresById.get(e);t&&this._remove(t)}this._emitChanged()}forEachBounds(t,e){for(const n of t){const t=this._boundsStore.get(n.objectId);t&&e((0,h.Jt)(f,t))}}getFeature(t){return this._featuresById.get(t)}has(t){return this._featuresById.has(t)}forEach(t){this._featuresById.forEach((e=>t(e)))}forEachInBounds(t,e){this._boundsStore.forEachInBounds(t,(t=>{e(this._featuresById.get(t))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let t=!1;this._featuresById.forEach(((e,n)=>{this._markedIds.has(n)||(t=!0,this._remove(e))})),this._markedIds.clear(),t&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(t){if(!t)return;const e=t.objectId;if(null==e)return void i.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new r.A("featurestore:invalid-feature","feature id is missing",{feature:t}));const n=this._featuresById.get(e);let s;if(this._markedIds.add(e),n?(t.displayId=n.displayId,s=this._boundsStore.get(e),this._boundsStore.delete(e)):null!=this.onFeatureAdd&&this.onFeatureAdd(t),!t.geometry?.coords?.length)return this._boundsStore.set(e,null),void this._featuresById.set(e,t);s=(0,a.jQ)(null!=s?s:(0,l.vt)(),t.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=s&&this._boundsStore.set(e,s),this._featuresById.set(e,t)}_upsert(t){const e=t?.objectId;if(null==e)return i.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new r.A("featurestore:invalid-feature","feature id is missing",{feature:t})),null;const n=this._featuresById.get(e);if(!n)return this._add(t),t;this._markedIds.add(e);const{geometry:s,attributes:o}=t;for(const t in o)n.attributes[t]=o[t];return s&&(n.geometry=s,this._boundsStore.set(e,(0,a.jQ)((0,l.vt)(),s,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),n}_remove(t){null!=this.onFeatureRemove&&this.onFeatureRemove(t);const e=t.objectId;return this._markedIds.delete(e),this._boundsStore.delete(e),this._featuresById.delete(e),t}}},5525:(t,e,n)=>{n.d(e,{BW:()=>Z,Ch:()=>rt,DF:()=>M,Di:()=>O,E2:()=>z,Nl:()=>K,Q4:()=>ot,Rk:()=>ht,Ux:()=>D,Ye:()=>q,ZF:()=>Q,eU:()=>L,eY:()=>J,jH:()=>W,jQ:()=>st,kz:()=>tt,oN:()=>U,q3:()=>$,qK:()=>E,qN:()=>S,z5:()=>P,zv:()=>V});var s=n(62991),r=n(80861),o=n(57725),i=n(46373),h=n(2532),l=n(56053),a=n(85747),u=n(97011),c=n(65977);function d(t,e){return t?e?4:3:e?3:2}const f=()=>r.A.getLogger("esri.layers.graphics.featureConversionUtils"),m={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},g=(t,e,n,s,r,o)=>{t[n]=r,t[n+1]=o},y=(t,e,n,s,r,o)=>{t[n]=r,t[n+1]=o,t[n+2]=e[s+2]},_=(t,e,n,s,r,o)=>{t[n]=r,t[n+1]=o,t[n+2]=e[s+3]},p=(t,e,n,s,r,o)=>{t[n]=r,t[n+1]=o,t[n+2]=e[s+2],t[n+3]=e[s+3]};function x(t,e,n,s){if(t){if(n)return e&&s?p:y;if(e&&s)return _}else if(e&&s)return y;return g}function I({scale:t,translate:e},n){return Math.round((n-e[0])/t[0])}function B({scale:t,translate:e},n){return Math.round((e[1]-n)/t[1])}function b({scale:t,translate:e},n,s){return n*t[s]+e[s]}function M(t,e,n){return t?e?n?T(t):Y(t):n?F(t):w(t):null}function w(t){const e=t.coords;return{x:e[0],y:e[1]}}function v(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t}function Y(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2]}}function X(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t}function F(t){const e=t.coords;return{x:e[0],y:e[1],m:e[2]}}function A(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.m,t}function T(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2],m:e[3]}}function N(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t.coords[3]=e.m,t}function G(t,e){return t&&e?N:t?X:e?A:v}function S(t,e,n=G(null!=e.z,null!=e.m)){return n(t,e)}function E(t,e,n){if(null==t)return null;const s=d(e,n),r=[];for(let e=0;e<t.coords.length;e+=s){const n=[];for(let r=0;r<s;r++)n.push(t.coords[e+r]);r.push(n)}return e?n?{points:r,hasZ:e,hasM:n}:{points:r,hasZ:e}:n?{points:r,hasM:n}:{points:r}}function j(t,e,n=d(e.hasZ,e.hasM)){t.lengths[0]=e.points.length;const s=t.coords;let r=0;for(const t of e.points)for(let e=0;e<n;e++)s[r++]=t[e];return t}function Z(t,e,n){if(!t)return null;const s=d(e,n),{coords:r,lengths:o}=t,i=[];let h=0;for(const t of o){const e=[];for(let n=0;n<t;n++){const t=[];for(let e=0;e<s;e++)t.push(r[h++]);e.push(t)}i.push(e)}return e?n?{paths:i,hasZ:e,hasM:n}:{paths:i,hasZ:e}:n?{paths:i,hasM:n}:{paths:i}}function k(t,e,n=d(e.hasZ,e.hasM)){const{lengths:s,coords:r}=t;let o=0;for(const t of e.paths){for(const e of t)for(let t=0;t<n;t++)r[o++]=e[t];s.push(t.length)}return t}function P(t,e,n){if(!t)return null;const s=d(e,n),{coords:r,lengths:o}=t,i=[];let h=0;for(const t of o){const e=[];for(let n=0;n<t;n++){const t=[];for(let e=0;e<s;e++)t.push(r[h++]);e.push(t)}i.push(e)}return e?n?{rings:i,hasZ:e,hasM:n}:{rings:i,hasZ:e}:n?{rings:i,hasM:n}:{rings:i}}function q(t,e,n=e.hasZ,s=e.hasM){return L(t,e.rings,n,s)}function L(t,e,n,s){const r=d(n,s),{lengths:o,coords:i}=t;let h=0;lt(t);for(const t of e){for(const e of t)for(let t=0;t<r;t++)i[h++]=e[t];o.push(t.length)}return t}const R=[],C=[];function z(t,e,n,s,r){R[0]=t;const[o]=O(C,R,e,n,s,r);return at(R),at(C),o}function O(t,e,n,r,o,i){if(at(t),!n){for(const n of e){const e=i?n.attributes[i]:void 0;t.push(new a.Om(null,n.attributes,null,e))}return t}switch(n){case"esriGeometryPoint":return function(t,e,n,s,r){const o=G(n,s);for(const{geometry:n,attributes:s}of e){const e=null!=n?o(new c.A,n):null;t.push(new a.Om(e,s,null,r?s[r]:void 0))}return t}(t,e,r,o,i);case"esriGeometryMultipoint":return function(t,e,n,s,r){const o=d(n,s);for(const{geometry:n,attributes:s}of e){const e=null!=n?j(new c.A,n,o):null;t.push(new a.Om(e,s,null,r?s[r]:void 0))}return t}(t,e,r,o,i);case"esriGeometryPolyline":return function(t,e,n,s,r){const o=d(n,s);for(const{geometry:n,attributes:s,centroid:i}of e){const e=null!=n?k(new c.A,n,o):null,h=null!=i?S(new c.A,i):null;t.push(new a.Om(e,s,h,r?s[r]:void 0))}return t}(t,e,r,o,i);case"esriGeometryPolygon":return function(t,e,n,s,r){for(const{geometry:o,centroid:i,attributes:h}of e){const e=null!=o?q(new c.A,o,n,s):null,l=r?h[r]:void 0;null!=i?t.push(new a.Om(e,h,v(new c.A,i),l)):t.push(new a.Om(e,h,null,l))}return t}(t,e,r,o,i);default:f().error("convertToFeatureSet:unknown-geometry",new s.A(`Unable to parse unknown geometry type '${n}'`)),at(t)}return t}function U(t,e,n,s){C[0]=t,H(R,C,e,n,s);const r=R[0];return at(R),at(C),r}function D(t,e,n){if(null==t)return null;const r=new c.A;return"hasZ"in t&&null==e&&(e=t.hasZ),"hasM"in t&&null==n&&(n=t.hasM),(0,l.fT)(t)?G(null!=e?e:null!=t.z,null!=n?n:null!=t.m)(r,t):(0,l.Bi)(t)?q(r,t,e,n):(0,l.Rg)(t)?k(r,t,d(e,n)):(0,l.U9)(t)?j(r,t,d(e,n)):void f().error("convertFromGeometry:unknown-geometry",new s.A(`Unable to parse unknown geometry type '${t}'`))}function V(t,e,n,r){const o=t&&("coords"in t?t:t.geometry);if(null==o)return null;switch(e){case"esriGeometryPoint":{let t=w;return n&&r?t=T:n?t=Y:r&&(t=F),t(o)}case"esriGeometryMultipoint":return E(o,n,r);case"esriGeometryPolyline":return Z(o,n,r);case"esriGeometryPolygon":return P(o,n,r);default:return f().error("convertToGeometry:unknown-geometry",new s.A(`Unable to parse unknown geometry type '${e}'`)),null}}function H(t,e,n,r,o){if(at(t),null==n)return function(t,e){for(const n of e)t.push({attributes:n.attributes});return t}(t,e);switch(n){case"esriGeometryPoint":return function(t,e,n,s){let r=w;n&&s?r=T:n?r=Y:s&&(r=F);for(const n of e){const{geometry:e,attributes:s}=n,o=null!=e?r(e):null;t.push({attributes:s,geometry:o})}return t}(t,e,r,o);case"esriGeometryMultipoint":return function(t,e,n,s){for(const{geometry:r,attributes:o}of e)t.push({attributes:o,geometry:null!=r?E(r,n,s):null});return t}(t,e,r,o);case"esriGeometryPolyline":return function(t,e,n,s){for(const{geometry:r,attributes:o}of e)t.push({attributes:o,geometry:null!=r?Z(r,n,s):null});return t}(t,e,r,o);case"esriGeometryPolygon":return function(t,e,n,s){for(const{geometry:r,attributes:o,centroid:i}of e){const e=null!=r?P(r,n,s):null;if(null!=i){const n=w(i);t.push({attributes:o,centroid:n,geometry:e})}else t.push({attributes:o,geometry:e})}return t}(t,e,r,o);default:f().error("convertToFeatureSet:unknown-geometry",new s.A(`Unable to parse unknown geometry type '${n}'`))}return t}function Q(t){const{objectIdFieldName:e,spatialReference:n,transform:s,fields:r,hasM:o,hasZ:i,features:h,geometryType:l,exceededTransferLimit:a,uniqueIdField:u,queryGeometry:c,queryGeometryType:d}=t,f={features:H([],h,l,i,o),fields:r,geometryType:l,objectIdFieldName:e,spatialReference:n,uniqueIdField:u,queryGeometry:V(c,d,!1,!1)};return s&&(f.transform=s),a&&(f.exceededTransferLimit=a),o&&(f.hasM=o),i&&(f.hasZ=i),f}function $(t,e){const n=new u.A,{hasM:r,hasZ:o,features:i,objectIdFieldName:h,spatialReference:l,geometryType:a,exceededTransferLimit:c,transform:d,fields:m}=t;return m&&(n.fields=m),n.geometryType=a??null,n.objectIdFieldName=h??e??null,n.spatialReference=l??null,n.objectIdFieldName?(i&&O(n.features,i,a,o,r,n.objectIdFieldName),c&&(n.exceededTransferLimit=c),r&&(n.hasM=r),o&&(n.hasZ=o),d&&(n.transform=d),n):(f().error(new s.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function J(t){const{transform:e,features:n,hasM:s,hasZ:r}=t;if(!e)return t;for(const t of n)null!=t.geometry&&rt(t.geometry,t.geometry,s,r,e),null!=t.centroid&&rt(t.centroid,t.centroid,s,r,e);return t.transform=null,t}function W(t,e){const{geometryType:n,features:s,hasM:r,hasZ:o}=e;if(!t)return e;for(let e=0;e<s.length;e++){const i=s[e],h=i.weakClone();h.geometry=new c.A,K(h.geometry,i.geometry,r,o,n,t),i.centroid&&(h.centroid=new c.A,K(h.centroid,i.centroid,r,o,"esriGeometryPoint",t)),s[e]=h}return e.transform=t,e}function K(t,e,n,s,r,o,i=n,h=s){if(lt(t),!e?.coords.length)return null;const l=m[r],{coords:a,lengths:u}=e,c=d(n,s),f=d(n&&i,s&&h),g=x(n,s,i,h);if(!u.length)return g(t.coords,a,0,0,I(o,a[0]),B(o,a[1])),lt(t,c,0),t;let y,_,p,b,M=0,w=0,v=w;for(const e of u){if(e<l)continue;let n=0;w=v,p=y=I(o,a[M]),b=_=B(o,a[M+1]),g(t.coords,a,w,M,p,b),n++,M+=c,w+=f;for(let s=1;s<e;s++,M+=c)p=I(o,a[M]),b=B(o,a[M+1]),p===y&&b===_||(g(t.coords,a,w,M,p-y,b-_),w+=f,n++,y=p,_=b);n>=l&&(t.lengths.push(n),v=w)}return at(t.coords,v),t.coords.length?t:null}function tt(t,e,n,s,r,o,i=n,h=s){if(lt(t),!e?.coords.length)return null;const l=m[r],{coords:a,lengths:u}=e,c=d(n,s),f=d(n&&i,s&&h),g=x(n,s,i,h);if(!u.length)return g(t.coords,a,0,0,a[0],a[1]),lt(t,c,0),t;let y=0;const _=o*o;for(const e of u){if(e<l){y+=e*c;continue}const n=t.coords.length/f,s=y,r=y+(e-1)*c;g(t.coords,a,t.coords.length,s,a[s],a[s+1]),nt(t.coords,a,c,_,g,s,r),g(t.coords,a,t.coords.length,r,a[r],a[r+1]);const o=t.coords.length/f-n;o>=l?t.lengths.push(o):at(t.coords,n*f),y+=e*c}return t.coords.length?t:null}function et(t,e,n,s){const r=t[e],o=t[e+1],i=t[n],h=t[n+1],l=t[s],a=t[s+1];let u=i,c=h,d=l-u,f=a-c;if(0!==d||0!==f){const t=((r-u)*d+(o-c)*f)/(d*d+f*f);t>1?(u=l,c=a):t>0&&(u+=d*t,c+=f*t)}return d=r-u,f=o-c,d*d+f*f}function nt(t,e,n,s,r,o,i){let h,l=s,a=0;for(let t=o+n;t<i;t+=n)h=et(e,t,o,i),h>l&&(a=t,l=h);l>s&&(a-o>n&&nt(t,e,n,s,r,o,a),r(t,e,t.length,a,e[a],e[a+1]),i-a>n&&nt(t,e,n,s,r,a,i))}function st(t,e,n,s){if(!e?.coords?.length)return null;const r=d(n,s);let o=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(e&&e.coords){const t=e.coords;for(let e=0;e<t.length;e+=r){const n=t[e],s=t[e+1];o=Math.min(o,n),a=Math.max(a,n),l=Math.min(l,s),u=Math.max(u,s)}}return(0,i.is)(t)?(0,i.BI)(t,o,l,a,u):(0,h.fA)(o,l,a,u,t),t}function rt(t,e,n,s,r){const{coords:i,lengths:h}=e,l=d(n,s);if(!i.length)return t!==e&&lt(t),t;(0,o.Lw)(r);const{originPosition:a,scale:u,translate:c}=r,f=ut;f.originPosition=a;const m=f.scale;m[0]=u[0]??1,m[1]=-(u[1]??1),m[2]=u[2]??1,m[3]=u[3]??1;const g=f.translate;if(g[0]=c[0]??0,g[1]=c[1]??0,g[2]=c[2]??0,g[3]=c[3]??0,!h.length){for(let e=0;e<l;++e)t.coords[e]=b(f,i[e],e);return t!==e&&lt(t,l,0),t}let y=0;for(let e=0;e<h.length;e++){const n=h[e];t.lengths[e]=n;for(let e=0;e<l;++e)t.coords[y+e]=b(f,i[y+e],e);let s=t.coords[y],r=t.coords[y+1];y+=l;for(let e=1;e<n;e++,y+=l){s+=i[y]*m[0],r+=i[y+1]*m[1],t.coords[y]=s,t.coords[y+1]=r;for(let e=2;e<l;++e)t.coords[y+e]=b(f,i[y+e],e)}}return t!==e&&lt(t,i.length,h.length),t}function ot(t,e,n,s,r,o){if(lt(t),t.lengths.push(...e.lengths),n===r&&s===o)for(let n=0;n<e.coords.length;n++)t.coords.push(e.coords[n]);else{const i=d(n,s),h=x(n,s,r,o),l=e.coords;for(let e=0;e<l.length;e+=i)h(t.coords,l,t.coords.length,e,l[e],l[e+1])}return t}function it(t,e,n,s){let r=0,o=t[s*e],i=t[s*(e+1)];for(let h=1;h<n;h++){const n=o+t[s*(e+h)],l=i+t[s*(e+h)+1],a=(n-o)*(l+i);o=n,i=l,r+=a}return.5*r}function ht(t,e){const{coords:n,lengths:s}=t;let r=0,o=0;for(let t=0;t<s.length;t++){const i=s[t];o+=it(n,r,i,e),r+=i}return Math.abs(o)}function lt(t,e=0,n=0){at(t.lengths,n),at(t.coords,e)}function at(t,e=0){t.length!==e&&(t.length=e)}const ut={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}}}]);