"use strict";(self.webpackChunkmadaster_typescript=self.webpackChunkmadaster_typescript||[]).push([[7648],{72449:(t,e,n)=>{n.d(e,{a:()=>s,b:()=>a,c:()=>o,d:()=>i,e:()=>l,f:()=>u,n:()=>f,s:()=>h,t:()=>c}),n(6273);var r=n(83851);function i(t,e,n){s(t.typedBuffer,e.typedBuffer,n,t.typedBufferStride,e.typedBufferStride)}function s(t,e,n,r=3,i=r){if(t.length/r!==Math.ceil(e.length/i))return t;const s=t.length/r,o=n[0],a=n[1],u=n[2],h=n[4],c=n[5],l=n[6],f=n[8],d=n[9],g=n[10],m=n[12],y=n[13],v=n[14];let p=0,b=0;for(let n=0;n<s;n++){const n=e[p],s=e[p+1],A=e[p+2];t[b]=o*n+h*s+f*A+m,t[b+1]=a*n+c*s+d*A+y,t[b+2]=u*n+l*s+g*A+v,p+=i,b+=r}return t}function o(t,e,n){a(t.typedBuffer,e.typedBuffer,n,t.typedBufferStride,e.typedBufferStride)}function a(t,e,n,i=3,s=i){if(t.length/i!==Math.ceil(e.length/s))return void(0,r.j)().error("source and destination buffers need to have the same number of elements");const o=t.length/i,a=n[0],u=n[1],h=n[2],c=n[3],l=n[4],f=n[5],d=n[6],g=n[7],m=n[8];let y=0,v=0;for(let n=0;n<o;n++){const n=e[y],r=e[y+1],o=e[y+2];t[v]=a*n+c*r+d*o,t[v+1]=u*n+l*r+g*o,t[v+2]=h*n+f*r+m*o,y+=s,v+=i}}function u(t,e,n){h(t.typedBuffer,e,n,t.typedBufferStride)}function h(t,e,n,r=3){const i=Math.min(t.length/r,e.count),s=e.typedBuffer,o=e.typedBufferStride;let a=0,u=0;for(let e=0;e<i;e++)t[u]=n*s[a],t[u+1]=n*s[a+1],t[u+2]=n*s[a+2],a+=o,u+=r}function c(t,e,n,r=3,i=r){const s=t.length/r;if(s!==Math.ceil(e.length/i))return t;let o=0,a=0;for(let u=0;u<s;u++)t[a]=e[o]+n[0],t[a+1]=e[o+1]+n[1],t[a+2]=e[o+2]+n[2],o+=i,a+=r;return t}function l(t,e){f(t.typedBuffer,e.typedBuffer,t.typedBufferStride,e.typedBufferStride)}function f(t,e,n=3,r=n){const i=Math.min(t.length/n,e.length/r);let s=0,o=0;for(let a=0;a<i;a++){const i=e[s],a=e[s+1],u=e[s+2],h=i*i+a*a+u*u;if(h>0){const e=1/Math.sqrt(h);t[o]=e*i,t[o+1]=e*a,t[o+2]=e*u}s+=r,o+=n}}Object.freeze(Object.defineProperty({__proto__:null,normalize:f,normalizeView:l,scale:h,scaleView:u,shiftRight:function(t,e,n){const r=Math.min(t.count,e.count),i=t.typedBuffer,s=t.typedBufferStride,o=e.typedBuffer,a=e.typedBufferStride;let u=0,h=0;for(let t=0;t<r;t++)i[h]=o[u]>>n,i[h+1]=o[u+1]>>n,i[h+2]=o[u+2]>>n,u+=a,h+=s},transformMat3:a,transformMat3View:o,transformMat4:s,transformMat4View:i,translate:c},Symbol.toStringTag,{value:"Module"}))},51831:(t,e,n)=>{n.d(e,{Dg:()=>i,EH:()=>f,JH:()=>o,my:()=>s,tM:()=>c});var r=n(62088);function i(t){if((0,r.cy)(t)){if(t.length<r.y9)return t}else if(t.length<r.y9)return Array.from(t);let e=!0,n=!0;return t.some(((t,r)=>(e=e&&0===t,n=n&&t===r,!e&&!n))),e?f(t.length):n?c(t.length):(0,r.cy)(t)||t.BYTES_PER_ELEMENT!==Uint16Array.BYTES_PER_ELEMENT?function(t){let e=!0;for(const n of t){if(n>=65536)return(0,r.cy)(t)?new Uint32Array(t):t;n>=256&&(e=!1)}return e?new Uint8Array(t):new Uint16Array(t)}(t):t}function s(t){return t<=r.y9?new Array(t):t<=65536?new Uint16Array(t):new Uint32Array(t)}function o(t){return t<=r.y9?new Array(t):new Uint32Array(t)}let a=(()=>{const t=new Uint32Array(131072);for(let e=0;e<t.length;++e)t[e]=e;return t})();const u=[0],h=(()=>{const t=new Uint16Array(65536);for(let e=0;e<t.length;++e)t[e]=e;return t})();function c(t){if(1===t)return u;if(t<r.y9)return Array.from(new Uint16Array(h.buffer,0,t));if(t<h.length)return new Uint16Array(h.buffer,0,t);if(t>a.length){const e=Math.max(2*a.length,t);a=new Uint32Array(e);for(let t=0;t<a.length;t++)a[t]=t}return new Uint32Array(a.buffer,0,t)}let l=new Uint8Array(65536);function f(t){if(1===t)return u;if(t<r.y9)return new Array(t).fill(0);if(t>l.length){const e=Math.max(2*l.length,t);l=new Uint8Array(e)}return new Uint8Array(l.buffer,0,t)}},83851:(t,e,n)=>{n.d(e,{j:()=>i});var r=n(80861);const i=()=>r.A.getLogger("esri.views.3d.support.buffer.math")},94669:(t,e,n)=>{n.d(e,{Cr:()=>h,H6:()=>f,_I:()=>l,kb:()=>c,ld:()=>d,vt:()=>u});var r=n(4506),i=n(82444),s=n(80347),o=n(19913),a=n(11631);function u(t){return t?{origin:(0,o.o8)(t.origin),vector:(0,o.o8)(t.vector)}:{origin:(0,o.vt)(),vector:(0,o.vt)()}}function h(t,e,n=u()){return(0,s.c)(n.origin,t),(0,s.f)(n.vector,e,t),n}function c(t,e){const n=(0,s.f)(a.rq.get(),e,t.origin),i=(0,s.j)(t.vector,n),o=(0,s.j)(t.vector,t.vector),u=(0,r.qE)(i/o,0,1),h=(0,s.f)(a.rq.get(),(0,s.h)(a.rq.get(),t.vector,u),n);return(0,s.j)(h,h)}function l(t,e,n){return f(t,e,0,1,n)}function f(t,e,n,i,o){const{vector:u,origin:h}=t,c=(0,s.f)(a.rq.get(),e,h),l=(0,s.j)(u,c)/(0,s.o)(u);return(0,s.h)(o,u,(0,r.qE)(l,n,i)),(0,s.g)(o,o,t.origin)}function d(t,e,n){return!!function(t,e,n,i){const o=1e-6,u=t.origin,h=(0,s.g)(a.rq.get(),u,t.vector),c=e.origin,l=(0,s.g)(a.rq.get(),c,e.vector),f=a.rq.get(),d=a.rq.get();if(f[0]=u[0]-c[0],f[1]=u[1]-c[1],f[2]=u[2]-c[2],d[0]=l[0]-c[0],d[1]=l[1]-c[1],d[2]=l[2]-c[2],Math.abs(d[0])<o&&Math.abs(d[1])<o&&Math.abs(d[2])<o)return!1;const g=a.rq.get();if(g[0]=h[0]-u[0],g[1]=h[1]-u[1],g[2]=h[2]-u[2],Math.abs(g[0])<o&&Math.abs(g[1])<o&&Math.abs(g[2])<o)return!1;const m=f[0]*d[0]+f[1]*d[1]+f[2]*d[2],y=d[0]*g[0]+d[1]*g[1]+d[2]*g[2],v=f[0]*g[0]+f[1]*g[1]+f[2]*g[2],p=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],b=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*p-y*y;if(Math.abs(b)<o)return!1;let A=(m*y-v*p)/b,M=(m+y*A)/p;n&&(A=(0,r.qE)(A,0,1),M=(0,r.qE)(M,0,1));const _=a.rq.get(),I=a.rq.get();return _[0]=u[0]+A*g[0],_[1]=u[1]+A*g[1],_[2]=u[2]+A*g[2],I[0]=c[0]+M*d[0],I[1]=c[1]+M*d[1],I[2]=c[2]+M*d[2],i.tA=A,i.tB=M,i.pA=_,i.pB=I,i.distance2=(0,s.a)(_,I),!0}(t,e,!0,g)&&((0,s.c)(n,g.pA),!0)}const g={tA:0,tB:0,pA:(0,o.vt)(),pB:(0,o.vt)(),distance2:0};new i.I((()=>u()))},73411:(t,e,n)=>{n.d(e,{J:()=>i});var r=n(78851);class i{constructor(){this.id=(0,r.c)()}}},61723:(t,e,n)=>{var r;n.d(e,{X:()=>r}),function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"}(r||(r={}))},24960:(t,e,n)=>{n.d(e,{V:()=>P});var r=n(26110),i=n(80347),s=n(51831),o=n(62088);function a(t){if(t.length<o.y9)return Array.from(t);if((0,o.cy)(t))return Float64Array.from(t);if(!("BYTES_PER_ELEMENT"in t))return Array.from(t);switch(t.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(t);case 2:return(0,o.jq)(t)?Uint16Array.from(t):Int16Array.from(t);case 4:return Float32Array.from(t);default:return Float64Array.from(t)}}var u=n(10875),h=n(41785),c=n(19913),l=n(26421);class f{constructor(t,e,n){this.primitiveIndices=t,this._numIndexPerPrimitive=e,this.position=n,this._children=void 0,(0,l.vA)(t.length>=1),(0,l.vA)(3===n.size||4===n.size);const{data:r,size:s,indices:o}=n;(0,l.vA)(o.length%this._numIndexPerPrimitive==0),(0,l.vA)(o.length>=t.length*this._numIndexPerPrimitive);const a=t.length;let u=s*o[this._numIndexPerPrimitive*t[0]];d.clear(),d.push(u);const h=(0,c.fA)(r[u],r[u+1],r[u+2]),f=(0,c.o8)(h);for(let e=0;e<a;++e){const n=this._numIndexPerPrimitive*t[e];for(let t=0;t<this._numIndexPerPrimitive;++t){u=s*o[n+t],d.push(u);let e=r[u];h[0]=Math.min(e,h[0]),f[0]=Math.max(e,f[0]),e=r[u+1],h[1]=Math.min(e,h[1]),f[1]=Math.max(e,f[1]),e=r[u+2],h[2]=Math.min(e,h[2]),f[2]=Math.max(e,f[2])}}this.bbMin=h,this.bbMax=f;const g=(0,i.k)((0,c.vt)(),this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(f[0]-h[0],f[1]-h[1]),f[2]-h[2]);let m=this.radius*this.radius;for(let t=0;t<d.length;++t){u=d.at(t);const e=r[u]-g[0],n=r[u+1]-g[1],i=r[u+2]-g[2],s=e*e+n*n+i*i;if(s<=m)continue;const o=Math.sqrt(s),a=.5*(o-this.radius);this.radius=this.radius+a,m=this.radius*this.radius;const h=a/o;g[0]+=e*h,g[1]+=n*h,g[2]+=i*h}this.center=g,d.clear()}getChildren(){if(this._children||(0,i.a)(this.bbMin,this.bbMax)<=1)return this._children;const t=(0,i.k)((0,c.vt)(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,n=new Uint8Array(e),r=new Array(8);for(let t=0;t<8;++t)r[t]=0;const{data:s,size:o,indices:a}=this.position;for(let i=0;i<e;++i){let e=0;const u=this._numIndexPerPrimitive*this.primitiveIndices[i];let h=o*a[u],c=s[h],l=s[h+1],f=s[h+2];for(let t=1;t<this._numIndexPerPrimitive;++t){h=o*a[u+t];const e=s[h],n=s[h+1],r=s[h+2];e<c&&(c=e),n<l&&(l=n),r<f&&(f=r)}c<t[0]&&(e|=1),l<t[1]&&(e|=2),f<t[2]&&(e|=4),n[i]=e,++r[e]}let u=0;for(let t=0;t<8;++t)r[t]>0&&++u;if(u<2)return;const h=new Array(8);for(let t=0;t<8;++t)h[t]=r[t]>0?new Uint32Array(r[t]):void 0;for(let t=0;t<8;++t)r[t]=0;for(let t=0;t<e;++t){const e=n[t];h[e][r[e]++]=this.primitiveIndices[t]}this._children=new Array;for(let t=0;t<8;++t)void 0!==h[t]&&this._children.push(new f(h[t],this._numIndexPerPrimitive,this.position));return this._children}static prune(){d.prune()}}const d=new h.A({deallocator:null});var g=n(73411),m=n(61723),y=n(82444),v=n(94669);function p(t,e,n){return(0,i.f)(b,e,t),(0,i.f)(A,n,t),.5*(0,i.l)((0,i.b)(b,b,A))}n(11631),new y.I(v.vt),new y.I((()=>{return t?{p0:(0,c.o8)(t.p0),p1:(0,c.o8)(t.p1),p2:(0,c.o8)(t.p2)}:{p0:(0,c.vt)(),p1:(0,c.vt)(),p2:(0,c.vt)()};var t}));const b=(0,c.vt)(),A=(0,c.vt)(),M=(0,c.vt)(),_=(0,c.vt)(),I=(0,c.vt)(),O=(0,c.vt)();var w=n(32685),B=n(33763),E=n(93550);class P extends g.J{constructor(t,e,n=null,r=m.X.Mesh,i=null,o=-1){super(),this.material=t,this.mapPositions=n,this.type=r,this.objectAndLayerIdColor=i,this.edgeIndicesLength=o,this.visible=!0,this._attributes=new Map,this._boundingInfo=null;for(const[t,n]of e)this._attributes.set(t,{...n,indices:(0,s.Dg)(n.indices)}),t===B.r.POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._attributes.get(t).indices.length:this.edgeIndicesLength)}instantiate(t={}){const e=new P(t.material||this.material,[],this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);return this._attributes.forEach(((t,n)=>{t.exclusive=!1,e._attributes.set(n,t)})),e._boundingInfo=this._boundingInfo,e.transformation=t.transformation||this.transformation,e}get attributes(){return this._attributes}getMutableAttribute(t){let e=this._attributes.get(t);return e&&!e.exclusive&&(e={...e,exclusive:!0,data:a(e.data)},this._attributes.set(t,e)),e}setAttributeData(t,e){const n=this._attributes.get(t);n&&this._attributes.set(t,{...n,exclusive:!0,data:e})}get indexCount(){const t=this._attributes.values().next().value.indices;return t?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return!!(this.type===m.X.Mesh?this._computeAttachmentOriginTriangles(t):this.type===m.X.Line?this._computeAttachmentOriginLines(t):this._computeAttachmentOriginPoints(t))&&(null!=this._transformation&&(0,i.e)(t,t,this._transformation),!0)}_computeAttachmentOriginTriangles(t){return function(t,e){if(!t)return!1;const{size:n,data:r,indices:s}=t;(0,i.s)(e,0,0,0),(0,i.s)(O,0,0,0);let o=0,a=0;for(let t=0;t<s.length-2;t+=3){const u=s[t]*n,h=s[t+1]*n,c=s[t+2]*n;(0,i.s)(M,r[u],r[u+1],r[u+2]),(0,i.s)(_,r[h],r[h+1],r[h+2]),(0,i.s)(I,r[c],r[c+1],r[c+2]);const l=p(M,_,I);l?((0,i.g)(M,M,_),(0,i.g)(M,M,I),(0,i.h)(M,M,1/3*l),(0,i.g)(e,e,M),o+=l):((0,i.g)(O,O,M),(0,i.g)(O,O,_),(0,i.g)(O,O,I),a+=3)}return!(0===a&&0===o||(0!==o?((0,i.h)(e,e,1/o),0):0===a||((0,i.h)(e,O,1/a),0)))}(this.attributes.get(B.r.POSITION),t)}_computeAttachmentOriginLines(t){const e=this.attributes.get(B.r.POSITION);return function(t,e,n){if(!t)return!1;(0,i.s)(n,0,0,0),(0,i.s)(O,0,0,0);let r=0,s=0;const{size:o,data:a,indices:u}=t,h=u.length-1,c=h+(e?2:0);for(let t=0;t<c;t+=2){const e=t<h?t+1:0,c=u[t<h?t:h]*o,l=u[e]*o;M[0]=a[c],M[1]=a[c+1],M[2]=a[c+2],_[0]=a[l],_[1]=a[l+1],_[2]=a[l+2],(0,i.h)(M,(0,i.g)(M,M,_),.5);const f=(0,i.m)(M,_);f>0?((0,i.g)(n,n,(0,i.h)(M,M,f)),r+=f):0===r&&((0,i.g)(O,O,M),s++)}return 0!==r?((0,i.h)(n,n,1/r),!0):0!==s&&((0,i.h)(n,O,1/s),!0)}(e,function(t,e){return!(!("isClosed"in t)||!t.isClosed)&&e.indices.length>2}(this.material.parameters,e),t)}_computeAttachmentOriginPoints(t){return function(t,e){if(!t)return!1;const{size:n,data:r,indices:s}=t;(0,i.s)(e,0,0,0);let o=-1,a=0;for(let t=0;t<s.length;t++){const i=s[t]*n;o!==i&&(e[0]+=r[i],e[1]+=r[i+1],e[2]+=r[i+2],a++),o=i}return a>1&&(0,i.h)(e,e,1/a),a>0}(this.attributes.get(B.r.POSITION),t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.attributes.get(B.r.POSITION);if(!t||0===t.indices.length)return null;const e=this.type===m.X.Mesh?3:1;(0,l.vA)(t.indices.length%e==0,"Indexing error: "+t.indices.length+" not divisible by "+e);const n=(0,s.tM)(t.indices.length/e);return new f(n,e,t)}get transformation(){return this._transformation??r.zK}set transformation(t){this._transformation=t&&t!==r.zK?(0,r.o8)(t):null}addHighlight(){const t=new w.X(u.Mg.Highlight);return this.highlights=(0,E.Ci)(this.highlights,t),t}removeHighlight(t){this.highlights=(0,E.PC)(this.highlights,t)}}},32685:(t,e,n)=>{n.d(e,{X:()=>i});var r=n(78851);class i{constructor(t){this.channel=t,this.id=(0,r.c)()}}},10875:(t,e,n)=>{var r,i,s,o,a,u,h,c,l;n.d(e,{Am:()=>o,ID:()=>c,JS:()=>l,Mg:()=>u,dd:()=>a,it:()=>i,s2:()=>r,sf:()=>h}),function(t){t[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.COUNT=3]="COUNT"}(r||(r={})),function(t){t[t.Less=0]="Less",t[t.Lequal=1]="Lequal",t[t.COUNT=2]="COUNT"}(i||(i={})),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.UPDATE=1]="UPDATE"}(s||(s={})),function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(o||(o={})),function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(a||(a={})),function(t){t[t.Highlight=0]="Highlight",t[t.MaskOccludee=1]="MaskOccludee",t[t.COUNT=2]="COUNT"}(u||(u={})),function(t){t[t.Blend=0]="Blend",t[t.Opaque=1]="Opaque",t[t.Mask=2]="Mask",t[t.MaskBlend=3]="MaskBlend",t[t.COUNT=4]="COUNT"}(h||(h={})),function(t){t[t.OFF=0]="OFF",t[t.ON=1]="ON"}(c||(c={})),function(t){t.DDS_ENCODING="image/vnd-ms.dds",t.KTX2_ENCODING="image/ktx2",t.BASIS_ENCODING="image/x.basis"}(l||(l={}))},93550:(t,e,n)=>{n.d(e,{Ci:()=>s,PC:()=>o,Vk:()=>a});var r=n(19913),i=n(3016);function s(t,e){return null==t&&(t=[]),t.push(e),t}function o(t,e){if(null==t)return null;const n=t.filter((t=>t!==e));return 0===n.length?null:n}function a(t,e,n,r,s){u[0]=t.get(e,0),u[1]=t.get(e,1),u[2]=t.get(e,2),(0,i.jS)(u,h,3),n.set(s,0,h[0]),r.set(s,0,h[1]),n.set(s,1,h[2]),r.set(s,1,h[3]),n.set(s,2,h[4]),r.set(s,2,h[5])}const u=(0,r.vt)(),h=new Float32Array(6)},3016:(t,e,n)=>{function r(t,e,n){for(let r=0;r<n;++r)e[2*r]=t[r],e[2*r+1]=t[r]-e[2*r]}function i(t,e){const n=t.length;for(let r=0;r<n;++r)o[0]=t[r],e[r]=o[0];return e}function s(t,e){const n=t.length;for(let r=0;r<n;++r)o[0]=t[r],o[1]=t[r]-o[0],e[r]=o[1];return e}n.d(e,{Zo:()=>i,jA:()=>s,jS:()=>r});const o=new Float32Array(2)}}]);