"use strict";(self.webpackChunkmadaster_typescript=self.webpackChunkmadaster_typescript||[]).push([[1600],{82444:(t,e,r)=>{r.d(e,{I:()=>n});var s=r(71709);class n{constructor(t){this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,s.d)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*a);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}_grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,a));t++)this._items.push(this._allocator())}}const a=1024},64159:(t,e,r)=>{r.d(e,{W:()=>i,g:()=>o});var s=r(19913),n=r(34561),a=r(88133);function o(t,e,r,s){if((0,n.canProjectWithoutEngine)(t.spatialReference,r)){u[0]=t.x,u[1]=t.y;const n=t.z;return u[2]=n??s??0,(0,a.projectBuffer)(u,t.spatialReference,0,e,r,0,1)}const o=(0,n.tryProjectWithZConversion)(t,r);return!!o&&(e[0]=o?.x,e[1]=o?.y,e[2]=o?.z??s??0,!0)}async function i(t,e,r,s,a){return await(0,n.initializeProjection)(t.spatialReference,r,null,a),o(t,e,r,s)}const u=(0,s.vt)()},78621:(t,e,r)=>{r.r(e),r.d(e,{assetMapFromAssetMapsJSON:()=>E,extractMesh:()=>d,meshFeatureSetFromJSON:()=>g});var s=r(20857),n=r(80861),a=r(80294),o=r(8e3),i=r(53170),u=r(8977),c=r(44153),l=r(77873),f=r(28936),h=r(52360),m=r(74704);const p=()=>n.A.getLogger("esri.rest.support.meshFeatureSet");function g(t,e,r){const n=r.features;r.features=[],delete r.geometryType;const a=m.A.fromJSON(r);if(a.geometryType="mesh",!r.assetMaps)return a;const o=E(e,r.assetMaps),i=t.sourceSpatialReference??c.A.WGS84,u=r.globalIdFieldName,{outFields:l}=t,f=null!=l&&l.length>0?(h=l.includes("*")?null:new Set(l),({attributes:t})=>{if(!t)return{};if(!h)return t;for(const e in t)h.has(e)||delete t[e];return t}):()=>({});var h;for(const t of n){const r=d(t,u,i,e,o);null!=r&&a.features.push(new s.A({geometry:r,attributes:f(t)}))}return a}function d(t,e,r,s,n){const a=t.attributes[e],c=n.get(a);if(null==c)return p().error("mesh-feature-set:asset-not-found","Service returned a feature which was not found in the asset map",t),null;if(!t.geometry)return p().error("mesh-feature-set:no-geometry","Service returned a feature without geometry",t),null;const h=function({attributes:t},e,{transformFieldRoles:r}){const s=t[r.originX],n=t[r.originY],a=t[r.originZ];return new u.A({x:s,y:n,z:a,spatialReference:e})}(t,r,s),m=o.A.fromJSON(t.geometry);m.spatialReference=r;const g=function(t,{transformFieldRoles:e}){return new l.A({translation:[t[e.translationX],-t[e.translationZ],t[e.translationY]],rotationAxis:[t[e.rotationX],-t[e.rotationZ],t[e.rotationY]],rotationAngle:t[e.rotationDeg],scale:[t[e.scaleX],t[e.scaleZ],t[e.scaleY]]})}(t.attributes,s),d=r.isGeographic?"local":"georeferenced",_=function(t){const e=Array.from(t.files.values()),r=new Array;for(const t of e){if(t.status!==y.COMPLETED)return null;const e=new Array;for(const r of t.parts){if(!r)return null;e.push(new f.Bq(r.url,r.hash))}r.push(new f.Qp(t.name,t.mimeType,e))}return r}(c);return _?i.A.createWithExternalSource(h,_,{extent:m,transform:g,vertexSpace:d}):i.A.createIncomplete(h,{extent:m,transform:g,vertexSpace:d})}var y,_;function E(t,e){const r=new Map;for(const s of e){const e=s.parentGlobalId;if(null==e)continue;const n=s.assetName,o=s.assetType,i=s.assetHash,u=s.assetURL,c=s.conversionStatus,l=s.seqNo,f=(0,h.Fm)(o,t.supportedFormats);if(!f){p().error("mesh-feature-set:unknown-format",`Service returned an asset of type ${o}, but it does not list it as a supported type`);continue}const m=(0,a.tE)(r,e,(()=>({files:new Map})));(0,a.tE)(m.files,n,(()=>({name:n,type:o,mimeType:f,status:w(c),parts:[]}))).parts[l]={hash:i,url:u}}return r}function w(t){switch(t){case"COMPLETED":case"SUBMITTED":return y.COMPLETED;case"INPROGRESS":return y.PENDING;default:return y.FAILED}}(_=y||(y={}))[_.FAILED=0]="FAILED",_[_.PENDING=1]="PENDING",_[_.COMPLETED=2]="COMPLETED"}}]);